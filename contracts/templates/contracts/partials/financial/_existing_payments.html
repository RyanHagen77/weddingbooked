<div class="text-right">
    <div class="contract-total" data-contract-total="{{ contract.calculate_total_cost }}">
        <strong>Total Contract Amount:</strong> ${{ contract.calculate_total_cost }}
    </div>

    <!-- Add a new amount here -->
    <div class="amount-paid" data-payments-made="{{ contract.amount_paid }}">
        <strong>Amount Paid:</strong> ${{ contract.amount_paid|floatformat:2 }}
    </div>

    <div class="balance-due" data-initial-balance="{{ contract.balance_due }}">
        <strong>Balance Due:</strong> <span id="balance-due-amount">${{ contract.balance_due|floatformat:2 }}</span>
    </div>
</div>

<h6>Existing Payments:</h6>
<table class="table table-hover existing-payments-table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Amount</th>
            <th>Method</th>
            <th>Purpose</th>
            <th>Reference</th>
            <th>Memo</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for payment in contract.payments.all %}
            <tr data-payment-id="{{ payment.id }}" data-payment-purpose="{{ payment.payment_purpose.name }}">
                <td>{{ payment.date }}</td>
                <td>${{ payment.amount }}</td>
                <td>{{ payment.get_payment_method_display }}</td>
                <td>{{ payment.payment_purpose.name }}</td>
                <td>{{ payment.payment_reference }}</td>
                <td>{{ payment.memo }}</td>
                <td>
                    <button type="button" class="btn btn-info btn-sm" onclick="editPayment('{{ payment.id }}', '{{ payment.amount }}', '{{ payment.payment_method }}', '{{ payment.payment_reference }}', '{{ payment.memo }}', '{{ payment.payment_purpose.id }}')">Edit</button>
                    <button type="button" class="btn btn-danger btn-sm" onclick="if(confirm('Are you sure?')){ window.location.href='{% url 'payments:delete_payment' payment.id %}'; }">Delete</button>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
